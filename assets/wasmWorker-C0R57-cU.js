(function(){"use strict";async function ur(i={}){var c,n=i,k=typeof window=="object",U=typeof WorkerGlobalScope<"u";typeof process=="object"&&process.versions?.node&&process.type!="renderer";var T="./this.program",F=self.location.href,m="";function H(r){return n.locateFile?n.locateFile(r,m):m+r}var B,M;if(k||U){try{m=new URL(".",F).href}catch{}U&&(M=r=>{var e=new XMLHttpRequest;return e.open("GET",r,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),B=async r=>{var e=await fetch(r,{credentials:"same-origin"});if(e.ok)return e.arrayBuffer();throw new Error(e.status+" : "+e.url)}}console.log.bind(console);var y=console.error.bind(console),p,h=!1,_,b,w,d,W,j,V,g,$,L,O,Y=!1;function X(){var r=w.buffer;d=new Int8Array(r),j=new Int16Array(r),n.HEAPU8=W=new Uint8Array(r),n.HEAP32=V=new Int32Array(r),g=new Uint32Array(r),$=new Float32Array(r),L=new Float64Array(r),O=new BigInt64Array(r),new BigUint64Array(r)}function gr(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Er(n.preRun.shift());J(Z)}function mr(){Y=!0,S.h()}function dr(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Rr(n.postRun.shift());J(Q)}function I(r){n.onAbort?.(r),r="Aborted("+r+")",y(r),h=!0,r+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(r);throw b?.(e),e}var z;function hr(){return n.locateFile?H("index.wasm"):new URL("/Img2Num/assets/index-CsYpdeMy.wasm",self.location.href).href}function _r(r){if(r==z&&p)return new Uint8Array(p);if(M)return M(r);throw"both async and sync fetching of the wasm failed"}async function yr(r){if(!p)try{var e=await B(r);return new Uint8Array(e)}catch{}return _r(r)}async function br(r,e){try{var t=await yr(r),a=await WebAssembly.instantiate(t,e);return a}catch(f){y(`failed to asynchronously prepare wasm: ${f}`),I(f)}}async function pr(r,e,t){if(!r)try{var a=fetch(e,{credentials:"same-origin"}),f=await WebAssembly.instantiateStreaming(a,t);return f}catch(o){y(`wasm streaming compile failed: ${o}`),y("falling back to ArrayBuffer instantiation")}return br(e,t)}function wr(){return{a:Xr}}async function Ar(){function r(o,s){return S=o.exports,w=S.g,X(),Yr(S),S}function e(o){return r(o.instance)}var t=wr();if(n.instantiateWasm)return new Promise((o,s)=>{n.instantiateWasm(t,(l,A)=>{o(r(l))})});z??=hr();var a=await pr(p,z,t),f=e(a);return f}var J=r=>{for(;r.length>0;)r.shift()(n)},Q=[],Rr=r=>Q.push(r),Z=[],Er=r=>Z.push(r);function Pr(r,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":return d[r];case"i8":return d[r];case"i16":return j[r>>1];case"i32":return V[r>>2];case"i64":return O[r>>3];case"float":return $[r>>2];case"double":return L[r>>3];case"*":return g[r>>2];default:I(`invalid type for getValue: ${e}`)}}function Ur(r,e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":d[r]=e;break;case"i8":d[r]=e;break;case"i16":j[r>>1]=e;break;case"i32":V[r>>2]=e;break;case"i64":O[r>>3]=BigInt(e);break;case"float":$[r>>2]=e;break;case"double":L[r>>3]=e;break;case"*":g[r>>2]=e;break;default:I(`invalid type for setValue: ${t}`)}}var Tr=r=>or(r),Mr=()=>cr();class Sr{constructor(e){this.excPtr=e,this.ptr=e-24}set_type(e){g[this.ptr+4>>2]=e}get_type(){return g[this.ptr+4>>2]}set_destructor(e){g[this.ptr+8>>2]=e}get_destructor(){return g[this.ptr+8>>2]}set_caught(e){e=e?1:0,d[this.ptr+12]=e}get_caught(){return d[this.ptr+12]!=0}set_rethrown(e){e=e?1:0,d[this.ptr+13]=e}get_rethrown(){return d[this.ptr+13]!=0}init(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)}set_adjusted_ptr(e){g[this.ptr+16>>2]=e}get_adjusted_ptr(){return g[this.ptr+16>>2]}}var q=0,kr=(r,e,t)=>{var a=new Sr(r);throw a.init(e,t),q=r,q},Fr=()=>I(""),Hr=(r,e,t,a)=>{if(!(a>0))return 0;for(var f=t,o=t+a-1,s=0;s<r.length;++s){var l=r.codePointAt(s);if(l<=127){if(t>=o)break;e[t++]=l}else if(l<=2047){if(t+1>=o)break;e[t++]=192|l>>6,e[t++]=128|l&63}else if(l<=65535){if(t+2>=o)break;e[t++]=224|l>>12,e[t++]=128|l>>6&63,e[t++]=128|l&63}else{if(t+3>=o)break;e[t++]=240|l>>18,e[t++]=128|l>>12&63,e[t++]=128|l>>6&63,e[t++]=128|l&63,s++}}return e[t]=0,t-f},x=(r,e,t)=>Hr(r,W,e,t),Br=()=>2147483648,Wr=(r,e)=>Math.ceil(r/e)*e,Cr=r=>{var e=w.buffer.byteLength,t=(r-e+65535)/65536|0;try{return w.grow(t),X(),1}catch{}},Nr=r=>{var e=W.length;r>>>=0;var t=Br();if(r>t)return!1;for(var a=1;a<=4;a*=2){var f=e*(1+.2/a);f=Math.min(f,r+100663296);var o=Math.min(t,Wr(Math.max(r,f),65536)),s=Cr(o);if(s)return!0}return!1},D={},Ir=()=>T||"./this.program",C=()=>{if(!C.strings){var r=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:r,_:Ir()};for(var t in D)D[t]===void 0?delete e[t]:e[t]=D[t];var a=[];for(var t in e)a.push(`${t}=${e[t]}`);C.strings=a}return C.strings},jr=(r,e)=>{var t=0,a=0;for(var f of C()){var o=e+t;g[r+a>>2]=o,t+=x(f,o,1/0)+1,a+=4}return 0},rr=r=>{for(var e=0,t=0;t<r.length;++t){var a=r.charCodeAt(t);a<=127?e++:a<=2047?e+=2:a>=55296&&a<=57343?(e+=4,++t):e+=3}return e},Vr=(r,e)=>{var t=C();g[r>>2]=t.length;var a=0;for(var f of t)a+=rr(f)+1;return g[e>>2]=a,0},$r=()=>r=>crypto.getRandomValues(r),er=r=>{(er=$r())(r)},Lr=(r,e)=>(er(W.subarray(r,r+e)),0),tr=r=>{var e=n["_"+r];return e},Or=(r,e)=>{d.set(r,e)},nr=r=>fr(r),zr=r=>{var e=rr(r)+1,t=nr(e);return x(r,t,e),t},ar=typeof TextDecoder<"u"?new TextDecoder:void 0,Dr=(r,e,t,a)=>{var f=e+t;if(a)return f;for(;r[e]&&!(e>=f);)++e;return e},Kr=(r,e=0,t,a)=>{var f=Dr(r,e,t,a);if(f-e>16&&r.buffer&&ar)return ar.decode(r.subarray(e,f));for(var o="";e<f;){var s=r[e++];if(!(s&128)){o+=String.fromCharCode(s);continue}var l=r[e++]&63;if((s&224)==192){o+=String.fromCharCode((s&31)<<6|l);continue}var A=r[e++]&63;if((s&240)==224?s=(s&15)<<12|l<<6|A:s=(s&7)<<18|l<<12|A<<6|r[e++]&63,s<65536)o+=String.fromCharCode(s);else{var R=s-65536;o+=String.fromCharCode(55296|R>>10,56320|R&1023)}}return o},ir=(r,e,t)=>r?Kr(W,r,e,t):"",sr=(r,e,t,a,f)=>{var o={string:v=>{var N=0;return v!=null&&v!==0&&(N=zr(v)),N},array:v=>{var N=nr(v.length);return Or(v,N),N}};function s(v){return e==="string"?ir(v):e==="boolean"?!!v:v}var l=tr(r),A=[],R=0;if(a)for(var E=0;E<a.length;E++){var lr=o[t[E]];lr?(R===0&&(R=Mr()),A[E]=lr(a[E])):A[E]=a[E]}var K=l(...A);function Qr(v){return R!==0&&Tr(R),s(v)}return K=Qr(K),K},Gr=(r,e,t,a)=>{var f=!t||t.every(s=>s==="number"||s==="boolean"),o=e!=="string";return o&&f&&!a?tr(r):(...s)=>sr(r,e,t,s)};if(n.noExitRuntime&&n.noExitRuntime,n.print&&n.print,n.printErr&&(y=n.printErr),n.wasmBinary&&(p=n.wasmBinary),n.arguments&&n.arguments,n.thisProgram&&(T=n.thisProgram),n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()();n.ccall=sr,n.cwrap=Gr,n.setValue=Ur,n.getValue=Pr,n.UTF8ToString=ir;var or,fr,cr;function Yr(r){n._bilateral_filter=r.i,n._gaussian_blur_fft=r.j,n._invert_image=r.k,n._threshold_image=r.l,n._black_threshold_image=r.m,n._kmeans=r.n,n._labels_to_svg=r.o,n._malloc=r.p,n._free=r.q,or=r.r,fr=r.s,cr=r.t}var Xr={a:kr,e:Fr,f:Nr,c:jr,d:Vr,b:Lr};function Jr(){gr();function r(){n.calledRun=!0,!h&&(mr(),_?.(n),n.onRuntimeInitialized?.(),dr())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),r()},1)):r()}var S;return S=await Ar(),Jr(),Y?c=n:c=new Promise((r,e)=>{_=r,b=e}),c}let u,G;const vr=new Promise(i=>G=i);ur().then(i=>{u=i,G()});const P={void:{},Int32Array:{alloc:i=>{const c=u._malloc(i.byteLength);return u.HEAP32.set(i,c/4),c},read:(i,c)=>new Int32Array(u.HEAP32.buffer,i,c).slice()},Uint8Array:{alloc:i=>{const c=u._malloc(i.byteLength);return u.HEAPU8.set(i,c),c},read:(i,c)=>new Uint8Array(u.HEAPU8.subarray(i,i+c)).slice()},Uint8ClampedArray:{alloc:i=>{const c=u._malloc(i.byteLength);return u.HEAPU8.set(i,c),c},read:(i,c)=>new Uint8ClampedArray(u.HEAPU8.subarray(i,i+c)).slice()},string:{alloc:i=>{const c=u.lengthBytesUTF8(i)+1,n=u._malloc(c);return u.stringToUTF8(i,n,c),n},read:i=>i?u.UTF8ToString(i):null}};self.onmessage=async({data:i})=>{await vr;const{id:c,funcName:n,args:k=void 0,bufferKeys:U=void 0,returnType:T="void"}=i;if(U?.length&&!k)throw new Error(`WASM call "${n}" has bufferKeys defined but no args object provided. Each bufferKey must correspond to a key in args.`);const F=new Map;try{const m=new Map(k?Object.entries(k):[]);U?.forEach(({key:h,type:_})=>{if(!(_ in P))throw new Error(`Unsupported type: ${_}`);const b=m.get(h),w=P[_].alloc(b);F.set(h,{ptr:w,type:_,length:b?.length}),m.set(h,w)});const H=`_${n}`;if(typeof u[H]!="function")throw new Error(`Export not found: ${H}`);const B=u[H](...m.values()),M=new Map;U?.forEach(({key:h,type:_})=>{const b=F.get(h);M.set(h,P[_].read(b.ptr,b.length))});let y=B;T&&P[T]!==P.void&&(y=P[T].read(B));const p=Object.fromEntries(M);self.postMessage({id:c,output:p,returnValue:y})}catch(m){self.postMessage({id:c,error:m.message})}finally{for(const{ptr:m}of F.values())u._free(m)}}})();
