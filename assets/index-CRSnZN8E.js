(function(){"use strict";async function fr(lr={}){var K,n=lr,de=typeof window=="object",C=typeof WorkerGlobalScope<"u";typeof process=="object"&&process.versions?.node&&process.type!="renderer";var v=C&&self.name?.startsWith("em-pthread"),he="./this.program",me=(e,r)=>{throw r},cr=self.location.href,Y="";function vr(e){return n.locateFile?n.locateFile(e,Y):Y+e}var _e,G;if(de||C){try{Y=new URL(".",cr).href}catch{}C&&(G=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),_e=async e=>{var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw new Error(r.status+" : "+r.url)}}var Q=console.log.bind(console),_=console.error.bind(console),E,U,L=!1,R;function f(){y.buffer!=g.buffer&&H()}var X,pe,ge;if(v){let e=function(r){try{var t=r.data,a=t.cmd;if(a==="load"){let s=[];self.onmessage=o=>s.push(o),ge=()=>{postMessage({cmd:"loaded"});for(let o of s)e(o);self.onmessage=e};for(const o of t.handlers)(!n[o]||n[o].proxy)&&(n[o]=(...i)=>{postMessage({cmd:"callHandler",handler:o,args:i})},o=="print"&&(Q=n[o]),o=="printErr"&&(_=n[o]));y=t.wasmMemory,H(),U=t.wasmModule,ke(),z()}else if(a==="run"){Wr(t.pthread_ptr),ce(t.pthread_ptr,0,0,1,0,0),l.threadInitTLS(),oe(t.pthread_ptr),Z||(Z=!0);try{Pr(t.start_routine,t.arg)}catch(s){if(s!="unwind")throw s}}else t.target==="setimmediate"||(a==="checkMailbox"?Z&&j():a&&(_(`worker: received unknown command ${a}`),_(t)))}catch(s){throw qe(),s}};var Z=!1;self.onunhandledrejection=r=>{throw r.reason||r},self.onmessage=e}var y,g,A,q,W,d,J,I,b,ye=!1,ee=!1;function H(){var e=y.buffer;g=new Int8Array(e),q=new Int16Array(e),n.HEAPU8=A=new Uint8Array(e),n.HEAP32=W=new Int32Array(e),d=new Uint32Array(e),J=new Float32Array(e),I=new Float64Array(e),b=new BigInt64Array(e),new BigUint64Array(e)}function dr(){if(!v){if(n.wasmMemory)y=n.wasmMemory;else{var e=n.INITIAL_MEMORY||1073741824;y=new WebAssembly.Memory({initial:e/65536,maximum:32768,shared:!0})}H()}}function hr(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Se(n.preRun.shift());We(Me)}function be(){if(ye=!0,v)return ge();T.u()}function mr(){v||(Ze(),et(),l.terminateAllThreads(),ee=!0)}function _r(){if(!v){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Ar(n.postRun.shift());We(Fe)}}function O(e){n.onAbort?.(e),e="Aborted("+e+")",_(e),L=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw pe?.(r),r}var re;function pr(){return n.locateFile?vr("index.wasm"):new URL("/Img2Num/assets/index-Do2f6jCb.wasm",self.location.href).href}function gr(e){if(e==re&&E)return new Uint8Array(E);if(G)return G(e);throw"both async and sync fetching of the wasm failed"}async function yr(e){if(!E)try{var r=await _e(e);return new Uint8Array(r)}catch{}return gr(e)}async function br(e,r){try{var t=await yr(e),a=await WebAssembly.instantiate(t,r);return a}catch(s){_(`failed to asynchronously prepare wasm: ${s}`),O(s)}}async function wr(e,r,t){if(!e)try{var a=fetch(r,{credentials:"same-origin"}),s=await WebAssembly.instantiateStreaming(a,t);return s}catch(o){_(`wasm streaming compile failed: ${o}`),_("falling back to ArrayBuffer instantiation")}return br(r,t)}function we(){return ft(),{a:or}}async function ke(){function e(i,u){return T=i.exports,Er(T.E),Be=T.v,U=u,ot(T),T}function r(i){return e(i.instance,i.module)}var t=we();if(n.instantiateWasm)return new Promise((i,u)=>{n.instantiateWasm(t,(c,h)=>{i(e(c,h))})});if(v){var a=new WebAssembly.Instance(U,we());return e(a,U)}re??=pr();var s=await wr(E,re,t),o=r(s);return o}class Te{name="ExitStatus";constructor(r){this.message=`Program terminated with exit(${r})`,this.status=r}}var Re=e=>{e.terminate(),e.onmessage=r=>{}},Ae=e=>{var r=l.pthreads[e];l.returnWorkerToPool(r)},We=e=>{for(;e.length>0;)e.shift()(n)},Me=[],Se=e=>Me.push(e),k=0,F=null,kr=e=>{if(k--,n.monitorRunDependencies?.(k),k==0&&F){var r=F;F=null,r()}},Tr=e=>{k++,n.monitorRunDependencies?.(k)},Pe=e=>{var r=l.getNewWorker();if(!r)return 6;l.runningWorkers.push(r),l.pthreads[e.pthread_ptr]=r,r.pthread_ptr=e.pthread_ptr;var t={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return r.postMessage(t,e.transferList),0},te=0,$=()=>se||te>0,Ee=()=>sr(),ne=e=>ar(e),ae=e=>ir(e),M=(e,r,t,...a)=>{for(var s=a.length*2,o=Ee(),i=ae(s*8),u=i>>3,c=0;c<a.length;c++){var h=a[c];typeof h=="bigint"?((f(),b)[u+2*c]=1n,(f(),b)[u+2*c+1]=h):((f(),b)[u+2*c]=0n,(f(),I)[u+2*c+1]=h)}var p=er(e,r,s,i,t);return ne(o),p};function Ue(e){if(v)return M(0,0,1,e);R=e,$()||(l.terminateAllThreads(),n.onExit?.(e),L=!0),me(e,new Te(e))}function Ie(e){if(v)return M(1,0,0,e);ie(e)}var Rr=(e,r)=>{if(R=e,v)throw Ie(e),"unwind";$()||mr(),Ue(e)},ie=Rr,l={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init(){v||l.initMainThread()},initMainThread(){for(var e=8;e--;)l.allocateUnusedWorker();Se(async()=>{var r=l.loadWasmModuleToAllWorkers();Tr(),await r,kr()})},terminateAllThreads:()=>{for(var e of l.runningWorkers)Re(e);for(var e of l.unusedWorkers)Re(e);l.unusedWorkers=[],l.runningWorkers=[],l.pthreads={}},returnWorkerToPool:e=>{var r=e.pthread_ptr;delete l.pthreads[r],l.unusedWorkers.push(e),l.runningWorkers.splice(l.runningWorkers.indexOf(e),1),e.pthread_ptr=0,rr(r)},threadInitTLS(){l.tlsInitFunctions.forEach(e=>e())},loadWasmModuleToWorker:e=>new Promise(r=>{e.onmessage=o=>{var i=o.data,u=i.cmd;if(i.targetThread&&i.targetThread!=x()){var c=l.pthreads[i.targetThread];c?c.postMessage(i,i.transferList):_(`Internal error! Worker sent a message "${u}" to target pthread ${i.targetThread}, but that thread no longer exists!`);return}u==="checkMailbox"?j():u==="spawnThread"?Pe(i):u==="cleanupThread"?$e(()=>Ae(i.thread)):u==="loaded"?(e.loaded=!0,r(e)):i.target==="setimmediate"?e.postMessage(i):u==="callHandler"?n[i.handler](...i.args):u&&_(`worker sent an unknown command ${u}`)},e.onerror=o=>{var i="worker sent an error!";throw _(`${i} ${o.filename}:${o.lineno}: ${o.message}`),o};var t=[],a=["onExit","onAbort","print","printErr"];for(var s of a)n.propertyIsEnumerable(s)&&t.push(s);e.postMessage({cmd:"load",handlers:t,wasmMemory:y,wasmModule:U})}),async loadWasmModuleToAllWorkers(){return v?void 0:Promise.all(l.unusedWorkers.map(l.loadWasmModuleToWorker))},allocateUnusedWorker(){var e;if(n.mainScriptUrlOrBlob){var r=n.mainScriptUrlOrBlob;typeof r!="string"&&(r=URL.createObjectURL(r)),e=new Worker(r,{type:"module",name:"em-pthread"})}else e=new Worker(self.location.href,{type:"module",name:"em-pthread"});l.unusedWorkers.push(e)},getNewWorker(){return l.unusedWorkers.length==0&&(l.allocateUnusedWorker(),l.loadWasmModuleToWorker(l.unusedWorkers[0])),l.unusedWorkers.pop()}},Fe=[],Ar=e=>Fe.push(e);function Wr(e){var r=(f(),d)[e+52>>2],t=(f(),d)[e+56>>2],a=r-t;nr(r,a),ne(r)}function Mr(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return(f(),g)[e];case"i8":return(f(),g)[e];case"i16":return(f(),q)[e>>1];case"i32":return(f(),W)[e>>2];case"i64":return(f(),b)[e>>3];case"float":return(f(),J)[e>>2];case"double":return(f(),I)[e>>3];case"*":return(f(),d)[e>>2];default:O(`invalid type for getValue: ${r}`)}}var Ne=[],Be,Sr=e=>{var r=Ne[e];return r||(Ne[e]=r=Be.get(e)),r},Pr=(e,r)=>{te=0,se=0;var t=Sr(e)(r);function a(s){if($()){R=s;return}ve(s)}a(t)},se=!1,Er=e=>l.tlsInitFunctions.push(e);function Ur(e,r,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":(f(),g)[e]=r;break;case"i8":(f(),g)[e]=r;break;case"i16":(f(),q)[e>>1]=r;break;case"i32":(f(),W)[e>>2]=r;break;case"i64":(f(),b)[e>>3]=BigInt(r);break;case"float":(f(),J)[e>>2]=r;break;case"double":(f(),I)[e>>3]=r;break;case"*":(f(),d)[e>>2]=r;break;default:O(`invalid type for setValue: ${t}`)}}class Ir{constructor(r){this.excPtr=r,this.ptr=r-24}set_type(r){(f(),d)[this.ptr+4>>2]=r}get_type(){return(f(),d)[this.ptr+4>>2]}set_destructor(r){(f(),d)[this.ptr+8>>2]=r}get_destructor(){return(f(),d)[this.ptr+8>>2]}set_caught(r){r=r?1:0,(f(),g)[this.ptr+12]=r}get_caught(){return(f(),g)[this.ptr+12]!=0}set_rethrown(r){r=r?1:0,(f(),g)[this.ptr+13]=r}get_rethrown(){return(f(),g)[this.ptr+13]!=0}init(r,t){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(t)}set_adjusted_ptr(r){(f(),d)[this.ptr+16>>2]=r}get_adjusted_ptr(){return(f(),d)[this.ptr+16>>2]}}var Ce=0,Fr=(e,r,t)=>{var a=new Ir(e);throw a.init(r,t),Ce=e,Ce};function Le(e,r,t,a){return v?M(2,0,1,e,r,t,a):He(e,r,t,a)}var Nr=()=>typeof SharedArrayBuffer<"u",He=(e,r,t,a)=>{if(!Nr())return 6;var s=[],o=0;if(v&&(s.length===0||o))return Le(e,r,t,a);var i={startRoutine:t,pthread_ptr:e,arg:a,transferList:s};return v?(i.cmd="spawnThread",postMessage(i,s),0):Pe(i)},Br=()=>O(""),Cr=e=>{ce(e,!C,1,!de,65536,!1),l.threadInitTLS()},Oe=e=>{if(e instanceof Te||e=="unwind")return R;me(1,e)},Lr=()=>{if(!ee&&!$())try{if(v){x()&&ve(R);return}ie(R)}catch(e){Oe(e)}},$e=e=>{if(!(ee||L))try{e(),Lr()}catch(r){Oe(r)}},oe=e=>{if(typeof Atomics.waitAsync=="function"){var r=Atomics.waitAsync((f(),W),e>>2,e);r.value.then(j);var t=e+128;Atomics.store((f(),W),t>>2,1)}},j=()=>$e(()=>{var e=x();e&&(oe(e),tr())}),Hr=(e,r)=>{if(e==r)setTimeout(j);else if(v)postMessage({targetThread:e,cmd:"checkMailbox"});else{var t=l.pthreads[e];if(!t)return;t.postMessage({cmd:"checkMailbox"})}},V=[],Or=(e,r,t,a,s)=>{a/=2,V.length=a;for(var o=s>>3,i=0;i<a;i++)(f(),b)[o+2*i]?V[i]=(f(),b)[o+2*i+1]:V[i]=(f(),I)[o+2*i+1];var u=st[e];l.currentProxiedOperationCallerThread=t;var c=u(...V);return l.currentProxiedOperationCallerThread=0,c},$r=e=>{v?postMessage({cmd:"cleanupThread",thread:e}):Ae(e)},jr=e=>{},Vr=(e,r,t,a)=>{if(!(a>0))return 0;for(var s=t,o=t+a-1,i=0;i<e.length;++i){var u=e.codePointAt(i);if(u<=127){if(t>=o)break;r[t++]=u}else if(u<=2047){if(t+1>=o)break;r[t++]=192|u>>6,r[t++]=128|u&63}else if(u<=65535){if(t+2>=o)break;r[t++]=224|u>>12,r[t++]=128|u>>6&63,r[t++]=128|u&63}else{if(t+3>=o)break;r[t++]=240|u>>18,r[t++]=128|u>>12&63,r[t++]=128|u>>6&63,r[t++]=128|u&63,i++}}return r[t]=0,t-s},S=(e,r,t)=>Vr(e,(f(),A),r,t),xr=(e,r,t,a)=>{var s=new Date().getFullYear(),o=new Date(s,0,1),i=new Date(s,6,1),u=o.getTimezoneOffset(),c=i.getTimezoneOffset(),h=Math.max(u,c);(f(),d)[e>>2]=h*60,(f(),W)[r>>2]=+(u!=c);var p=D=>{var m=D>=0?"-":"+",w=Math.abs(D),ut=String(Math.floor(w/60)).padStart(2,"0"),lt=String(w%60).padStart(2,"0");return`UTC${m}${ut}${lt}`},B=p(u),P=p(c);c<u?(S(B,t,17),S(P,a,17)):(S(B,a,17),S(P,t,17))},zr=()=>performance.timeOrigin+performance.now(),Dr=()=>{},Kr=()=>{te+=1},Yr=()=>{throw Kr(),"unwind"},Gr=()=>2147483648,Qr=(e,r)=>Math.ceil(e/r)*r,Xr=e=>{var r=y.buffer.byteLength,t=(e-r+65535)/65536|0;try{return y.grow(t),H(),1}catch{}},Zr=e=>{var r=(f(),A).length;if(e>>>=0,e<=r)return!1;var t=Gr();if(e>t)return!1;for(var a=1;a<=4;a*=2){var s=r*(1+.2/a);s=Math.min(s,e+100663296);var o=Math.min(t,Qr(Math.max(e,s),65536)),i=Xr(o);if(i)return!0}return!1},fe={},qr=()=>he||"./this.program",N=()=>{if(!N.strings){var e=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:qr()};for(var t in fe)fe[t]===void 0?delete r[t]:r[t]=fe[t];var a=[];for(var t in r)a.push(`${t}=${r[t]}`);N.strings=a}return N.strings};function je(e,r){if(v)return M(3,0,1,e,r);var t=0,a=0;for(var s of N()){var o=r+t;(f(),d)[e+a>>2]=o,t+=S(s,o,1/0)+1,a+=4}return 0}var Ve=e=>{for(var r=0,t=0;t<e.length;++t){var a=e.charCodeAt(t);a<=127?r++:a<=2047?r+=2:a>=55296&&a<=57343?(r+=4,++t):r+=3}return r};function xe(e,r){if(v)return M(4,0,1,e,r);var t=N();(f(),d)[e>>2]=t.length;var a=0;for(var s of t)a+=Ve(s)+1;return(f(),d)[r>>2]=a,0}var ue=[null,[],[]],ze=typeof TextDecoder<"u"?new TextDecoder:void 0,Jr=(e,r,t,a)=>{var s=r+t;if(a)return s;for(;e[r]&&!(r>=s);)++r;return r},De=(e,r=0,t,a)=>{var s=Jr(e,r,t,a);if(s-r>16&&e.buffer&&ze)return ze.decode(e.buffer instanceof ArrayBuffer?e.subarray(r,s):e.slice(r,s));for(var o="";r<s;){var i=e[r++];if(!(i&128)){o+=String.fromCharCode(i);continue}var u=e[r++]&63;if((i&224)==192){o+=String.fromCharCode((i&31)<<6|u);continue}var c=e[r++]&63;if((i&240)==224?i=(i&15)<<12|u<<6|c:i=(i&7)<<18|u<<12|c<<6|e[r++]&63,i<65536)o+=String.fromCharCode(i);else{var h=i-65536;o+=String.fromCharCode(55296|h>>10,56320|h&1023)}}return o},le=(e,r)=>{var t=ue[e];r===0||r===10?((e===1?Q:_)(De(t)),t.length=0):t.push(r)},et=()=>{Je(0),ue[1].length&&le(1,10),ue[2].length&&le(2,10)},Ke=(e,r,t)=>e?De((f(),A),e,r,t):"";function Ye(e,r,t,a){if(v)return M(5,0,1,e,r,t,a);for(var s=0,o=0;o<t;o++){var i=(f(),d)[r>>2],u=(f(),d)[r+4>>2];r+=8;for(var c=0;c<u;c++)le(e,(f(),A)[i+c]);s+=u}return(f(),d)[a>>2]=s,0}var rt=()=>e=>e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),Ge=e=>{(Ge=rt())(e)},tt=(e,r)=>(Ge((f(),A).subarray(e,e+r)),0),Qe=e=>{var r=n["_"+e];return r},nt=(e,r)=>{(f(),g).set(e,r)},at=e=>{var r=Ve(e)+1,t=ae(r);return S(e,t,r),t},Xe=(e,r,t,a,s)=>{var o={string:m=>{var w=0;return m!=null&&m!==0&&(w=at(m)),w},array:m=>{var w=ae(m.length);return nt(m,w),w}};function i(m){return r==="string"?Ke(m):r==="boolean"?!!m:m}var u=Qe(e),c=[],h=0;if(a)for(var p=0;p<a.length;p++){var B=o[t[p]];B?(h===0&&(h=Ee()),c[p]=B(a[p])):c[p]=a[p]}var P=u(...c);function D(m){return h!==0&&ne(h),i(m)}return P=D(P),P},it=(e,r,t,a)=>{var s=!t||t.every(i=>i==="number"||i==="boolean"),o=r!=="string";return o&&s&&!a?Qe(e):(...i)=>Xe(e,r,t,i)};if(l.init(),dr(),n.noExitRuntime&&(se=n.noExitRuntime),n.print&&(Q=n.print),n.printErr&&(_=n.printErr),n.wasmBinary&&(E=n.wasmBinary),n.arguments&&n.arguments,n.thisProgram&&(he=n.thisProgram),n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()();n.ccall=Xe,n.cwrap=it,n.setValue=Ur,n.getValue=Mr,n.UTF8ToString=Ke;var st=[Ue,Ie,Le,je,xe,Ye],x,Ze,ce,qe,Je,er,rr,ve,tr,nr,ar,ir,sr;function ot(e){n._bilateral_filter=e.w,n._gaussian_blur_fft=e.x,n._invert_image=e.y,n._threshold_image=e.z,n._black_threshold_image=e.A,n._kmeans=e.B,n._labels_to_svg=e.C,n._malloc=e.D,e.E,x=e.F,Ze=e.G,ce=e.H,qe=e.I,Je=e.J,n._free=e.K,er=e.L,rr=e.M,ve=e.N,tr=e.O,nr=e.P,ar=e.Q,ir=e.R,sr=e.S}var or;function ft(){or={b:Fr,g:He,q:Br,j:Cr,s:Hr,h:Or,d:$r,i:oe,l:jr,n:xr,e:Dr,k:Yr,c:zr,r:Zr,o:je,p:xe,t:ie,f:Ye,a:y,m:tt}}function z(){if(k>0){F=z;return}if(v){X?.(n),be();return}if(hr(),k>0){F=z;return}function e(){n.calledRun=!0,!L&&(be(),X?.(n),n.onRuntimeInitialized?.(),_r())}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),e()},1)):e()}var T;return v||(T=await ke(),z()),ye?K=n:K=new Promise((e,r)=>{X=e,pe=r}),K}var ur=globalThis.self?.name?.startsWith("em-pthread");ur&&fr()})();
